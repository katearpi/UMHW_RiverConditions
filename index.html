<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>DRAFT Upper Missouri River Headwaters River Conditions</title>

    <script src="extras/tablelist.js" type="text/javascript"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!--<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>-->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="assets/js/ie10-viewport-bug-workaround.js"></script>

    <script type="text/javascript">
        var package_path = location.pathname.replace(/\/[^/]+$/, "") + "/assets";
        var dojoConfig = {
            packages: [{
                name: "application",
                location: package_path
            }],
            paths: { extras: location.pathname.replace(/\/[^/]+$/, "") + "/extras" }
        };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js"></script>
    <!--<script src="//js.arcgis.com/3.13compact"></script>-->
    <script src="https://js.arcgis.com/3.13compact"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="/assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">
    <link href="Styles/jumbotron.css" rel="stylesheet">    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="Styles/tablelist.css" type="text/css" />
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" type="text/css" href="https://js.arcgis.com/3.13/esri/css/esri.css">
    <!--<link rel="stylesheet" type="text/css" href="//js.arcgis.com/3.13/esri/css/esri.css">-->
    <link rel="stylesheet" type="text/css" href="https://esri.github.io/bootstrap-map-js/src/css/bootstrapmap.css">
    <style>
        #mapDiv {/* Set the responsive map size here */
            min-height: 80px;
            max-height: 600px;
        }

        .esriScalebar{
            bottom:145px;
            margin-left: 0px;
        }
        .esriBasemapGalleryThumbnail {
            height: 40px;
            width: 40px;
        }
        .esriBasemapGalleryNode {
            width: 40px;
        }
    </style>
  </head>

<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Upper Missouri Headwaters</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <form class="navbar-form navbar-right">
                    <div id="block_container" style="color:white; ">
                        <div id="bloc1"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Beaverhead" style="color:white" target="_self">Beaverhead</a></div> |
                        <div id="bloc8"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Big Hole" style="color:white"  target="_self">Big Hole</a></div> |
                        <div id="bloc3"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Boulder" style="color:white"  target="_self">Boulder</a></div> |
                        <div id="bloc10"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Broadwater" style="color:white"  target="_self">Broadwater</a></div> |
                        <div id="bloc9"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Beaverhead" style="color:white"  target="_self">Centennial</a></div> |
                        <div id="bloc2"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Jefferson" style="color:white"  target="_self">Jefferson</a></div> |
                        <div id="bloc5"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Gallatin" style="color:white"  target="_self">Gallatin-Lower</a></div> |
                        <div id="bloc4"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Gallatin" style="color:white" target="_self">Gallatin-Upper</a></div> |
                        <div id="bloc6"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Madison" style="color:white"  target="_self">Madison</a></div> |
                        <div id="bloc7"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Ruby" style="color:white"  target="_self">Ruby</a></div>
                        
                    </div>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>

    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron" style="margin-bottom:-10px; padding-bottom:15px; padding-top:35px;">
        <div class="container" style="">
            <h2>Hello, watershed coordinators!</h2> This is DRAFT tool to help with providing examples of data, functionality, and style

            <a class="btn btn-primary btn-lg" href="#" role="button">Learn more (coming soon) &raquo;</a>
        </div>
    </div>

    <div class="container">
        <!-- Example row of columns -->
        <div class="row">
            <div class="col-md-4" style="padding-left: 1px; padding-right: 1px">
                <h2>Unofficial: Summary of Conditions</h2>
                <p>This will be developed to show other watershed conditions</p>
                <p id="txtFromToDate"></p>
                <table class="TableListJS" id="entries">
                    <thead>
                    </thead>
                    <tbody data-bind="foreach: {data: gageRecords}" style="font-size: 13px;">
                        <tr>
                            <td width="30%">
                                Stream Section: <br />
                                <div>Discharge(cfs)</div>
                                <div>Flow Status</div>
                                <div>Water Temp(C)</div>
                                <div>Temp Status</div>
                            </td>
                            <td width="70%">
                                <div>
                                    <a data-bind="text: SiteName, attr: {href: Hyperlink}" target="_blank"></a><br />
                                    <div><span data-bind='text: Discharge, attr: {title: formattedDischargeDateTime}'></span></div>
                                    <div><span data-bind='text: SiteFlowStatus'></span></div>
                                    <div><span data-bind='text: WaterTemp, attr: {title: formattedWaterTempDateTime}'></span></div>
                                    <div><span data-bind='text: SiteTempStatus'></span></div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div id="search"></div>
                <input id="btn_query_QS" type="button" value="Run Search/Filter" style="visibility: hidden;" />
            </div>
            <div class="col-md-8">
                <h2>DRAFT/Unofficial Map</h2>
                <div id="mapDiv"></div>
                <img id="loadingImg" src="images/loading.gif" style="position:fixed; right:40%; top:50%; z-index:100;" />
                <div style="position:absolute; right:15px; bottom:130px; z-Index:999;">
                    <div id="basemapGallery"></div>
                </div>
                <div id="txt_xyCoords" style="position:absolute; left:25px; bottom:125px; color:#404040; z-index:50; font-size:11px"></div>
                <div class="row">
                    <div class="col-xs-4">
                        <h5>Legend</h5>
                        <p>content</p>
                        <p>content</p>
                        <p>content</p>
                    </div>
                    <p>This map will be updated soon.. </p>
                    <p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>
                </div>
            </div>
            <div class="col-md-12">
                <h2>DRAFT/Unofficial Detail</h2>
                <p>This will hold detail inforamtion, tabs to other info, charts/graphs</p>
                <p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>
                <table class="red" style="width: 100%; height: 100%;">
                    <thead>
                        <tr>
                            <th class="right">Site Name</th>
                            <th class="right">agency</th>
                            <th>value</th>
                            <th class="right">Var/Unit</th>
                            <th class="right">DateTime</th>
                        </tr>
                    </thead>
                    <tbody id="display" class="no-border-x"></tbody>
                </table>
            </div>
        </div>

        <hr>

        <footer>
            <p>&copy; 2016 Company, Inc.</p>
        </footer>
    </div> <!-- /container -->


    <script>
        var editorWidget;
        var pSrcFeatureLayer;
        var pFCol;
        var app = {};
        require(["extras/MH_Setup", "extras/MH_GetGageData",
            "application/bootstrapmap",
            "dojo/parser",
            "dojo/domReady!"],

        function (MH_Setup, MH_GetGageData, BootstrapMap, parser) {
            parser.parse();
            esriConfig.defaults.io.proxyUrl = "/proxy/";

            app.pSup = new MH_Setup({}); // instantiate the class
            app.pSup.Phase1();

            app.pGage = new MH_GetGageData({}); // instantiate the class

            var dteDateTime = new Date();
            var strDateTime = dteDateTime.getFullYear() + "-" + ("0" + (dteDateTime.getMonth() + 1)).slice(-2) + "-" + ("0" + dteDateTime.getDate()).slice(-2);
            var strDateTimeUserFreindly = (dteDateTime.getMonth() + 1) + "/" + dteDateTime.getDate() + "/" + dteDateTime.getFullYear();

            var dteDateTimeMinus3 = new Date();
            dteDateTimeMinus3.setDate(dteDateTimeMinus3.getDate() - 3);
            var strDateTimeMinus3 = dteDateTimeMinus3.getFullYear() + "-" + ("0" + (dteDateTimeMinus3.getMonth() + 1)).slice(-2) + "-" + ("0" + dteDateTimeMinus3.getDate()).slice(-2);
            var strDateTimeMinus3UserFreindly = (dteDateTimeMinus3.getMonth() + 1) + "/" + dteDateTimeMinus3.getDate() + "/" + dteDateTimeMinus3.getFullYear();

            document.getElementById("txtFromToDate").innerHTML = "Conditions based on the last 3 days (" + strDateTimeMinus3UserFreindly.toString() + "-" + strDateTimeUserFreindly.toString() + ")";

            app.pGage.Start(strDateTimeMinus3, strDateTime);
        });
    </script>

</body>

</html>
