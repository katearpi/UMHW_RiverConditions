<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>DRAFT Upper Missouri River Headwaters River Conditions</title>

    <script src="extras/tablelist.js" type="text/javascript"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!--<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>-->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="assets/js/ie10-viewport-bug-workaround.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1','packages':['corechart'],'language':'en'}]}"></script>
    <!--<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>-->

    <script type="text/javascript">
        var package_path = location.pathname.replace(/\/[^/]+$/, "") + "/assets";
        var dojoConfig = {
            packages: [{
                name: "application",
                location: package_path
            }],
            paths: { extras: location.pathname.replace(/\/[^/]+$/, "") + "/extras" }
        };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js"></script>
    <!--<script src="//js.arcgis.com/3.13compact"></script>-->
    <script src="https://js.arcgis.com/3.12compact"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="/assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">
    <link href="Styles/jumbotron.css" rel="stylesheet">    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="Styles/tablelist.css" type="text/css" />
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" type="text/css" href="https://js.arcgis.com/3.13/esri/css/esri.css">
    <link rel="stylesheet" type="text/css" href="https://esri.github.io/bootstrap-map-js/src/css/bootstrapmap.css">
    <style>
        #mapDiv { /* Set the responsive map size here */
            min-height: 80px;
            max-height: 600px;
        }

        .esriScalebarLabel {
            font-size: 11px;
            font-style: normal;
            color:#404040;
        }

        .esriBasemapGalleryThumbnail {
            height: 40px;
            width: 40px;
        }

        .esriBasemapGalleryNode {
            width: 40px;
        }
        
        .esriLegendService {    /*between GIS layers*/
	        padding-bottom: 5px;
        }
        .esriLegendServiceLabel {
	        font-weight:bold;
        }
        .esriLegendLayerLabel {
	        padding-top: 15px;
        }
        
        .esriLegendLayer tr{   /*the row with all the symbols*/
            float:left;
            white-space: nowrap;
            border: none;
            border-width: 0px 0;
        }

        .esriLegendLayer {
            background-color: #BBD1E8;
        }

        .esriLegendLayer   tbody {   /*the table with all the symbols for a GIS layer*/
            height: 80%;
            overflow: hidden;
        }


    </style>
</head>

<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://mmheller.github.io/UMHW_RiverConditions/index.html">Upper Missouri Headwaters</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <form class="navbar-form navbar-right">

                    <ul id="navList" class="nav nav-pills pull-right">
                    </ul>


                    <!--<div id="block_container" style="color:white; ">
                        <div id="bloc1"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Beaverhead" style="color:white" target="_self">Beaverhead/Centennial</a></div> |
                        <div id="bloc8"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Big Hole" style="color:white"  target="_self">Big Hole</a></div> |
                        <div id="bloc3"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Boulder" style="color:white"  target="_self">Boulder</a></div> |
                        <div id="bloc10"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Broadwater" style="color:white"  target="_self">Broadwater</a></div> |
                        <div id="bloc2"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Jefferson" style="color:white"  target="_self">Jefferson</a></div> |
                        <div id="bloc5"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Lower Gallatin" style="color:white"  target="_self">Gallatin-Lower</a></div> |
                        <div id="bloc4"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Upper Gallatin" style="color:white" target="_self">Gallatin-Upper</a></div> |
                        <div id="bloc6"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Madison" style="color:white"  target="_self">Madison</a></div> |
                        <div id="bloc7"><a href="https://mmheller.github.io/UMHW_RiverConditions/index.html?H2O_ID=Ruby" style="color:white"  target="_self">Ruby</a></div>
                    </div>-->
                </form>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>

    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron" style="margin-bottom:-10px; padding-bottom:0px; padding-top:35px;">
        <div id="divWatershedBasinInfoTop" class="container" style="line-height: normal; padding:0px;">
        </div>
        <div id="divCustomAlert" class="container" style="line-height: normal; background-color: #fa021b;">
        </div>
    </div>
    
    <div class="container">
        <!-- Example row of columns -->
        <div class="row">
            <div class="col-md-3" style="padding-left: 1px; padding-right: 1px" id="entriesCon_div">
                <h2>Unofficial: Summary of Conditions</h2>
                <p><i>Click section below for detail display</i></p>
                <!--<p id="txtProcMessage">Blank</p>-->
                <p id="txtFromToDate"></p>
                <table class="TableListJS" id="entries">
                    <thead>
                    </thead>
                    <tbody data-bind="foreach: {data: gageRecords}" style="font-size: 13px;">
                        <tr style="cursor:pointer;" data-bind="click: $root.selectThing ">
                            <td width="95" valign="top">
                                <div>Stream Name</div>
                                <div>Section #/Desc</div>
                                <div>Discharge(cfs)</div>
                                <div>Flow Status</div>
                                <div>H2O Temp(F)</div>
                                <div>Temp Status</div>
                            </td>
                            <td valign="top">
                                <div>
                                    <div><span data-bind='text: StreamName'></span></div>
                                    <div><span data-bind='text: SectionID'></span> <span data-bind='text: SiteName'></span></div>
                                    <!--<div><span data-bind='text: SectionID'></span> <a data-bind="text: SiteName, attr: {href: Hyperlink}" target="_blank"></a></div>-->
                                    <div><span data-bind='text: Discharge, attr: {title: formattedDischargeDateTime}'></span>        (3 day trend <img height="16px" data-bind="attr:{src: Day3CFSTrend}" />)</div>
                                    <div><span data-bind='text: SiteFlowStatus'></span></div>
                                    <div><span data-bind='text: WaterTemp, attr: {title: formattedWaterTempDateTime}'></span>        (3 day trend <img height="16px" data-bind="attr:{src: Day3TMPTrend}" />)</div>
                                    <div><span data-bind='text: SiteTempStatus'></span></div>
                                </div>
                            </td>
                            <td class="htmlRowNotDisplayed">
                                <div><span data-bind='text: strMONTHDAYEarlyFlowFromDroughtManagementTarget'></span></div>
                                <div><span data-bind='text: strMONTHDAYEarlyFlowToDroughtManagementTarget'></span></div>
                                <div><span data-bind='text: iLateFlowPref4ConsvValue'></span></div>
                                <div><span data-bind='text: iLateFlowConsvValue'></span></div>
                                <div><span data-bind='text: iLateFlowClosureValueFlow'></span></div>
                                <div><span data-bind='text: strLateFlowPref4ConsvValue'></span></div>
                                <div><span data-bind='text: strLateFlowConsvValue'></span></div>
                                <div><span data-bind='text: strLateFlowClosureValueFlow'></span></div>
                                <div><span data-bind='text: iTempClosureValue'></span></div>
                                <div><span data-bind='text: strTempCollected'></span></div>
                                <div><span data-bind='text: strSiteID'></span></div>
                                <div><span data-bind='text: strDailyStat_URL'></span></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div id="search"></div>
                <input id="btn_query_QS" type="button" value="Run Search/Filter" style="visibility: hidden;" />
            </div>
            <div class="col-md-9" style="padding-top:20px; padding-right: 1px" >
                <div id="mapDiv"></div>
                <img id="loadingImg" src="images/loading.gif" style="position:fixed; right:40%; top:50%; z-index:100;" />

                <div id="block_container" style="position:relative; right:5px; bottom:50px; width:300px; z-Index:999; text-align:left">
                    <div id="basemapGallery"></div>

                </div>

                <div style="position:relative; left:200px; bottom:95px;">
                    <!--<span id="scaleDiv" style="position:relative; left:185px; bottom:110px; width:250px; font-size:11px"></span>-->
                    <div id="txt_xyCoords" style="color:#404040; width:200px; font-size:11px">Latitude: -, Longitude: -</div>
                    <div id="scaleDiv" style="width:250px; font-size:11px"></div>
                    
                </div>

                <div class="row" id="toggleLayers" style="position:relative; bottom:60px; left:25px; font-size:12px">
                    <div class="col-md-12">
                    </div>
                </div>

                <button type="button" class="btn btn-info" style="position:relative; font-size:12px; left:25px; bottom:55px; padding-top:1px; padding-bottom:1px; vertical-align:text-top;" data-toggle="collapse" data-target="#demo">Show/Hide Map Legend</button>
                <div id="demo" class="collapse  in"  style="position:relative; left:25px; bottom:55px;">
                    <h2>Map Legend</h2>
                    <div id="legendDiv" style="width:100%; padding: 2px 2px;"></div>
                </div>


                <div id="divSectionDetail" style="display:none; position:relative; bottom:60px; left:25px;">
                    <h2>Section Detail</h2>
                    <div style="margin: 15px 0 0 0;">
                        <div>Stream Name: <span data-bind='text: $root.CurrentDisplayGageRecord().StreamName'></span></div>
                        <div>Stream Section Number: <span data-bind='text: $root.CurrentDisplayGageRecord().SectionID'></span></div>
                        <div>Stream Section Description:  <span data-bind='text: $root.CurrentDisplayGageRecord().SiteName'></span></div>

                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().fwpDESCRIPTION'></span></div>
                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().fwpLOCATION'></span></div>
                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().fwpPRESSRELEASE'></span></div>
                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().fwpPUBLISHDATE'></span></div>
                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().fwpTITLE'></span></div>


                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().SiteTempStatus'></span></div>
                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().strMONTHDAYEarlyFlowFromDroughtManagementTarget'></span></div>
                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().strMONTHDAYEarlyFlowToDroughtManagementTarget'></span></div>

                                                
                        <div>USGS Source Data: <a data-bind="attr: {href: $root.CurrentDisplayGageRecord().Hyperlink}" target="_blank">Current</a> (Note: Some gages may not provide year round current data)</div>
                        <div>USGS Source Data: <a data-bind="attr: {href: $root.CurrentDisplayGageRecord().strDailyStat_URL}" target="_blank">Historical</a> (Note: Some gages may not provide year round historical data)</div>

                        <div></div>
                        <div></div>
                        <div>Stream Status based on Discharge(CFS):  <span data-bind='text: $root.CurrentDisplayGageRecord().SiteFlowStatus'></span></div>
                        <div>Current Discharge (CFS):  <span data-bind='text: $root.CurrentDisplayGageRecord().Discharge, attr: {title: $root.CurrentDisplayGageRecord().formattedDischargeDateTime}'></span>        (3 day trend <img height="16px" data-bind="attr:{src: $root.CurrentDisplayGageRecord().Day3CFSTrend}" />)</div>
                        <div></div>
                        <div><u>Target Definitions for this Stream Section</u></div>
                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().iLateFlowPref4ConsvValue'></span>:<span data-bind='text: $root.CurrentDisplayGageRecord().strLateFlowPref4ConsvValue'></span></div>
                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().iLateFlowConsvValue'></span>:<span data-bind='text: $root.CurrentDisplayGageRecord().strLateFlowConsvValue'></span></div>
                        <div><span data-bind='text: $root.CurrentDisplayGageRecord().iLateFlowClosureValueFlow'></span>:<span data-bind='text: $root.CurrentDisplayGageRecord().strLateFlowClosureValueFlow'></span></div>
                        <div></div>
                        <div></div>
                        <div>Current Water Temperature (F): <span data-bind='text: $root.CurrentDisplayGageRecord().WaterTemp, attr: {title: $root.CurrentDisplayGageRecord().formattedWaterTempDateTime}'></span>        (3 day trend <img height="16px" data-bind="attr:{src: $root.CurrentDisplayGageRecord().Day3TMPTrend}" />)</div>
                        <div>Temperature Closure Target: <span data-bind='text: $root.CurrentDisplayGageRecord().iTempClosureValue'></span></div>
                        <div>Temperature Collected: <span data-bind='text: $root.CurrentDisplayGageRecord().strTempCollected'></span></div>
                    </div>
                </div>

                <h2  style="position:relative; bottom:30px; left:25px;">Flow and Temperature Charts</h2>
                <div id="ViewModel2CFSBinding_div">
                    <div id="ViewModel2CFS_line_div" data-bind="googleBarChart: new ViewModel2CFS_LineData, chartOptions: {interpolateNulls: true,
                             legend: { position: 'none' }, chart: { title: 'title-text', subtitle: 'subtitle-text' }}">
                    </div>
                </div>

                <div id="ViewModel2TMPBinding_div">
                    <div id="ViewModel2TMP_line_div" data-bind="googleBarChart: new ViewModel2TMP_LineData, chartOptions: {interpolateNulls: true,
                             legend: { position: 'none' }, chart: { title: 'title-text', subtitle: 'subtitle-text' }}">
                    </div>
                </div>
            </div>
        </div>

        <hr>
        <footer>
            <p>Developed for The Upper Missouri Headwaters Basin and Associated Watersheds by.. version:1.0</p>
        </footer>
    </div> <!-- /container -->


    <script>
        var editorWidget;
        var pSrcFeatureLayer;
        var pFCol;
        var app = {};
        require(["extras/MH_Setup", "extras/MH_GetGageData", "extras/MH_GetWarningData",
            "application/bootstrapmap",
            "dojo/parser",
            "dojo/domReady!"],

        function (MH_Setup, MH_GetGageData, MH_GetWarningData, BootstrapMap, parser) {
            parser.parse();
            esriConfig.defaults.io.proxyUrl = "/proxy/";

            app.pSup = new MH_Setup({}); // instantiate the class
            app.pGetWarn = new MH_GetWarningData({}); // instantiate the class
            app.pGage = new MH_GetGageData({}); // instantiate the class


            app.pSup.Phase1();
        });
    </script>

</body>

</html>


